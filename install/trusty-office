#!/bin/sh
# -------------------------------------------------------
# Script to install office tools
#
# 20/12/2014, V1.0 - Creation by N. Bernaerts
# 22/12/2014, V1.1 - Add Gramps & dependancies
# 26/12/2014, V1.1 - Add nvpy (simple note)
# -------------------------------------------------------

# grisbi
sudo apt-get -y install grisbi

# gramps (genealogy)
sudo apt-get -y install gir1.2-gexiv2-0.10 gir1.2-osmgpsmap-1.0
sudo apt-get -y install gramps

# PDF editor
wget http://code-industry.net/public/master-pdf-editor_1.9.25_${ARCHI}.deb
sudo gdebi --n master-pdf-editor_1.9.25_*.deb

# Libreoffice : declare 4.3 PPA & install
sudo add-apt-repository -y ppa:libreoffice/libreoffice-4-3
sudo apt-get update
sudo apt-get -y install libreoffice libreoffice-gtk libreoffice-style-sifr

# declare file association 
xdg-mime default libreoffice-writer.desktop application/vnd.oasis.opendocument.text application/msword
xdg-mime default libreoffice-calc.desktop application/vnd.oasis.opendocument.spreadsheet application/vnd.ms-excel

# LibreOffice thumbnailer
sudo apt-get -y install libfile-mimeinfo-perl gvfs-bin unzip imagemagick
wget http://bernaerts.dyndns.org/download/gnome/thumbnailer/lo-thumbnailer-icons.zip
sudo unzip -d /usr/local/sbin lo-thumbnailer-icons.zip
rm lo-thumbnailer-icons.zip
sudo wget -O /usr/local/sbin/lo-thumbnailer https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/thumbnailer/libreoffice/lo-thumbnailer
sudo chmod +rx /usr/local/sbin/lo-thumbnailer
sudo wget -O /usr/share/thumbnailers/lo.thumbnailer https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/thumbnailer/libreoffice/lo.thumbnailer

# Ms Office thumbnailer
sudo apt-get -y install libfile-mimeinfo-perl gvfs-bin unoconv imagemagick
wget http://bernaerts.dyndns.org/download/gnome/thumbnailer/msoffice-thumbnailer-icons.zip
sudo unzip -d /usr/local/sbin msoffice-thumbnailer-icons.zip
rm msoffice-thumbnailer-icons.zip
sudo wget -O /usr/local/sbin/msoffice-thumbnailer https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/thumbnailer/msoffice/msoffice-thumbnailer
sudo chmod +rx /usr/local/sbin/msoffice-thumbnailer
sudo wget -O /usr/share/thumbnailers/msoffice.thumbnailer https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/thumbnailer/msoffice/msoffice.thumbnailer

# PDF repair extension
sudo apt-get -y install gvfs-bin libnotify-bin ghostscript zenity
sudo wget -O /usr/local/bin/pdf-repair https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/pdf-repair/pdf-repair
sudo chmod +x /usr/local/bin/pdf-repair
sudo wget -O /usr/share/applications/pdf-repair.desktop https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/pdf-repair/pdf-repair.desktop
mkdir --parents $HOME/.local/share/file-manager/actions
wget -O $HOME/.local/share/file-manager/actions/pdf-repair-action.desktop https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/pdf-repair/pdf-repair-action.desktop

# PDF booklet generation extension
sudo apt-get -y install poppler-utils pdfjam texlive-extra-utils
sudo wget -O /usr/local/bin/generate-booklet https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/generate-booklet/generate-booklet
sudo chmod +x /usr/local/bin/generate-booklet
sudo wget -O /usr/share/applications/generate-booklet.desktop https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/generate-booklet/generate-booklet.desktop
mkdir --parents $HOME/.local/share/file-manager/actions
wget -O $HOME/.local/share/file-manager/actions/generate-booklet-action.desktop https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/generate-booklet/generate-booklet-action.desktop

# nvpy
sudo apt-get -y install nvpy
wget -O $HOME/.nvpy.conf https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/nvpy/nvpy.conf
wget -O $HOME/.local/share/applications/nvpy.desktop https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/nvpy/nvpy.desktop
